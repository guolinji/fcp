`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date:    16:12:21 08/12/2017
// Design Name: 
// Module Name:    fcp physical layer
// Project Name: 
// Target Devices: 
// Tool versions: 
// Description: 
//
// Dependencies: 
//
// Revision: 
// Revision 0.01 - File Created
// Additional Comments: 
//
//////////////////////////////////////////////////////////////////////////////////

/*=================================================================================================================================================
Symbol     |Parameter                       |Condition              |Min.    |Typ.    |Max.    |Unit            |Notes
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tRISE      |Rise time                       |10% - 90%              |        |1       |3.6     |μs              |½ clock based on 125 kHz Osc.
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tFALL      |Fall time                       |90% - 10%              |        |1       |3.6     |μs              |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
UI         |Unit Interval for               |125 kHz clock assumed  |144     |160     |176     |μs              |20 * 1/125 kHz ± 10%
           |FCP PHY communication           |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
NRETRY     |Number of retries of            |RLOAD=15kΩ             |        |5       |        |tPING +tWAIT_F  |
           |first ping sequence             |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tB         |Data transfer bit rate          |                       |        |1       |        |UI              |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tB/4       |1/4 UI sync pulses              |                       |        |0.25    |        |UI              |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tPSLV      |Slave Ping Duration             |                       |        |16      |        |UI              |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tPMST      |Master Ping Duration            |                       |        |16      |        |UI              |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tMREQ      |Master Request Window.          |                       |1       |        |2       |UI              |
           |Duration from completion        |                       |        |        |        |                |
           |of slave ping.                  |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tSREQ      |Slave Request Window.           |                       |3       |        |5       |UI              |
           |Duration from completion        |                       |        |        |        |                |
           |of slave ping.                  |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tWAIT_F    |Wait time before                |                       |5       |        |        |UI              |
           |declaring failure.              |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tWAIT      |Wait time between               |                       |1       |        |5       |UI              |
           |transactions                    |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tFC_LOW    |Time transmitter must           |                       |        |        |1       |UI              |
           |actively drive the bus low      |                       |        |        |        |                |
           |after completing a transmission |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tVDP_SRC_ON|Time VDP_SRC is enabled         |                       |40      |60      |80      |ms              |Follows BC1.2 timing
           |after attach                    |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tSTART     |Transmitter is starting         |                       |        |1       |        |UI              |
           |data transmission               |                       |        |        |        |                |
-----------|--------------------------------|-----------------------|--------|--------|--------|----------------|----------------------------------
tRESET     |Master reset pulse duration     |                       |        |100     |        |UI              |
=================================================================================================================================================*/

module fcp_logical_layer (
    clk,
    rst_n,
    //
    data,
    tx_en,
);

localparam SLV_IDLE         = 4'd15

input       clk;
input       rst_n;

reg         [3:0] rx_cur_st;
reg         [3:0] rx_nxt_st;

reg         [3:0] tx_cur_st;
reg         [3:0] tx_nxt_st;

reg         [] dur_cnt;

// UI = 20 clock cycle
//========================================================================================
//========================================================================================
//              Rx
//========================================================================================
//========================================================================================
// Reg for how many clock cycle for a pluse

//========================================================================================
//========================================================================================
//              Tx
//========================================================================================
//========================================================================================


assign command_received     =;  // Rx finish
assign data_corrupted       =;  //Rx data corrupted: bad parity or bad crc
assign respond_done         =;  // Tx finish
assign slave_ping_send      =;  // Tx send out Ping

assign pl_bus_ready            =;


always @(posedge clk or negedge rstn) begin
    if (!rstn) begin
        require_respond <= 1'b0;
    end else if (pl_reset_from_master) begin
        require_respond <= 1'b0;
    end else if (command_received) begin
        require_respond <= 1'b1;
    end else if (respond_done) begin
        require_respond <= 1'b0;
    end
end

endmodule
